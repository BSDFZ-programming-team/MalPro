<h1 align="center">MalProüïµÔ∏è -- Malware classification by using assembly files!</h1>
<em><h3 align="center">Train your model & Analyze malwares quickly, easily, accurately!</h3></em>
<p align="center">
<img src=https://img.shields.io/badge/python-3.7+-blue?style=for-the-badge>
<img src=https://img.shields.io/badge/License-Apache2-green?style=for-the-badge>
<img src=https://img.shields.io/badge/State-Developing-red?style=for-the-badge>
<img src=https://img.shields.io/badge/Platform-Windows-orange?style=for-the-badge>
<em><h5 align="center">malware analyzer under python3 and machine learning</h5></em>
<img src=https://files.cnblogs.com/files/blogs/820580/logo.ico?t=1722150186&download=true>
ps: also a project for ‰∏äÊµ∑‰∫§ÈÄöÂ§ßÂ≠¶‰∫∫Â∑•Êô∫ËÉΩËç£Êò∂ÊùØ

# Background & Our Ideas

## What does our project do?

There are many products that use raw PE(.exe) file to classify malwares by using machine learning and/or extracting PE features. But instead, We are using assembly file of the raw PE file (generated by IDA) to classify it. 

Our project can classify 79 types of malware behaviour.

## Our ideas

### The background of our idea

When we are doing our research, we have noticed a bunch of project using cnn(or malconv, random forest, etc.) to classify the malware. 

Then, we saw a competition held by Microsoft (https://www.kaggle.com/competitions/malware-classification) that use .asm file to classify 9 different types of malware family. 

So could we classify more types of it? We have learned about the ideas of the champions from their blogs, articles and interviews. Finally, we decided that it could be a good idea.

### Why assembly file?

Features in assembly file are easier to be learned by machines than raw PE file.

We try to prove this as rigorous as possible, but because of the lack of time and cpu(I'm dead serious), we could only say that when only you got only 6000s and one cpu, training random forest models by using assembly file is better than PE file.

If you are interested in it, see [blog](#blog).

### Advantage of assembly files

The powerful features in assembly files are: 

	* .asm image features
	* opgram-ncode features
	
We train our random forest model by using these two features

by the way, we use 1500px for the .asm image features and n=4 for the opgram-ncode features in this project.

# Project usage

there is a model trained by us in the project file (model/model.pt), so you can predict the malware without training on your own

## requirments

### install python libraries

```
pip -r requirments.txt
```

**we recommend you to create a new virtual environment for this project cause it depends on some libraries in old version**

### install IDA pro

install IDA pro (7.x) from [here](https://hex-rays.com/IDA-pro/)

TODO

## Use

### predict

```
python server.py
```

It will run a web server on your host(port 7777) as the frontend of our project, open it and upload your .exe file, you will see a result like this.

![](https://files.cnblogs.com/files/blogs/820580/example.ico?t=1722150163&download=true)

download the analyze details if you want. 

### train

**download .asm dataset with labels**

Because of the copyright issues, we can't publish the dataset of 79 different behaviour of malwares, but instead, you can download the dataset of [kaggle](https://www.kaggle.com/competitions/malware-classification) which contains 9 type of malware famlies

**create /train folder and TrainLabels.csv**

copy your data set to /train and your label file to TrainLabels.csv(same label file format in the kaggle challenge)

*TIPS: if your train set is a subset of your label file(rename it to trainLabels_all.csv), use utils/convert.py to fix it.*

**Create a /subtrain folder**

`python randomsubset.py`

*TIPS: if you really don't know what to do, copy your /train and rename it to /subtrain, then run the script above.*

**Run main.py to train the model**

`python main.py`

it will show a menu like this

![](https://files.cnblogs.com/files/blogs/820580/example2.ico?t=1722150155&download=true)

you can train your model in this script

# Contributors

Project by: Âåó‰∫¨Â∏àËåÉÂ§ßÂ≠¶ÂçóÂ±±ÈôÑÂ±ûÂ≠¶Ê†°Ëç£Êò∂ÊùØÊØîËµõÂºÄÂèëÂ∞èÁªÑ

# Reports
Please send bug reports and feature requests through github issue tracker. Malpro is currently under development now and it's open to any constructive suggestions.

# License
The Malpro project is released under apache2 license.

# Blog

https://www.cnblogs.com/LAMENTXU/articles/18306874